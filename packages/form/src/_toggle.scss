////
/// @group form-toggle
////

@import '@react-md/button/dist/mixins';
@import '@react-md/states/dist/mixins';
@import '@react-md/theme/dist/mixins';
@import '@react-md/utils/dist/mixins';
@import 'theme';

/// Creates the minimal styles for a toggle container.
/// @access private
@mixin rmd-form-toggle-container {
  align-items: center;
  display: inline-flex;

  &--full-width {
    display: flex;
  }

  &--stacked {
    flex-direction: column;
  }
}

/// Creates all the styles for creating the icon container for the checkbox and radio input
/// types.
/// @access private
@mixin rmd-form-toggle {
  @include rmd-button-theme(height, icon-size);
  @include rmd-button-theme(width, icon-size);
  @include rmd-states-surface;
  @include rmd-states-keyboard-only {
    &--focused {
      @include rmd-states-theme-update-var(background-color, rmd-states-theme-var(focus-color));

      &:hover {
        @include rmd-states-theme-update-var(background-color, rmd-states-theme-var(hover-color));
      }
    }
  }

  align-items: center;
  border-radius: 50%;
  display: inline-flex;
  justify-content: center;
  position: relative;

  &--disabled {
    @include rmd-states-theme-update-var(hover-color, tranparent);
  }
}

/// Creates styles to apply to the "hidden" input for checkboxes and radios.
/// @access private
@mixin rmd-form-input-hidden {
  @include rmd-utils-hide-focus-outline;

  bottom: 0;
  height: 100%;
  left: 0;
  margin: 0;
  opacity: 0;
  position: absolute;
  right: 0;
  top: 0;
  width: 100%;
  z-index: 1;

  &:hover {
    cursor: pointer;
  }

  &:disabled {
    &:hover {
      cursor: default;
    }
  }
}

/// Creates the styles for a form input that should be hidden from view. This
/// should normally be applied to checkbox or radio input types.
/// @access private
@mixin rmd-form-toggle-hidden {
  @include rmd-form-input-hidden;

  &:checked + .rmd-form-toggle__icon::before {
    opacity: 0;
  }

  &:checked + .rmd-form-toggle__icon::after {
    opacity: 1;
  }
}

/// Creates the styles for the checkbox and radio input types' icon
/// @access private
@mixin rmd-form-toggle-icon {
  @include rmd-icon-theme(height, size);
  @include rmd-icon-theme(width, size);
  @include rmd-form-theme(color, active-color);

  .rmd-icon {
    color: inherit;
    fill: currentColor;
    height: inherit;
    width: inherit;
  }

  pointer-events: none;
  position: absolute;

  &--overlay {
    &::before,
    &::after {
      @include rmd-transition(standard);
      @include rmd-form-theme(bottom, toggle-inset);
      @include rmd-form-theme(left, toggle-inset);
      @include rmd-form-theme(right, toggle-inset);
      @include rmd-form-theme(top, toggle-inset);

      content: '';
      position: absolute;
      transition: opacity $rmd-transition-standard-time;
    }

    &::before {
      @include rmd-theme(background-color, background);

      opacity: 1;
      z-index: 3;
    }

    &::after {
      opacity: 0;
      z-index: 0;
    }
  }

  &--circle::before,
  &--circle::after {
    border-radius: $rmd-form-toggle-border-radius;
  }

  &--disabled {
    @include rmd-theme(color, text-disabled-on-background);
  }

  &--dense {
    @include rmd-form-theme(bottom, toggle-dense-inset);
    @include rmd-form-theme(left, toggle-dense-inset);
    @include rmd-form-theme(right, toggle-dense-inset);
    @include rmd-form-theme(top, toggle-dense-inset);
  }
}

/// Updates the checkbox and radio components to have a dense theme by updating the toggle-inset
/// css variable to be the dense version. This should generally be used within media queries.
@mixin rmd-form-toggle-dense-theme {
  @include rmd-form-theme-update-var(toggle-inset, rmd-form-theme-var(toggle-dense-inset));
}

/// Creates the styles for the switch component
/// @access private
@mixin rmd-switch {
  @include rmd-transition(standard);
  @include rmd-form-theme(background-color, track-background-color);

  border-radius: $rmd-switch-track-border-radius;
  height: $rmd-switch-track-height;
  position: relative;
  transition: background-color $rmd-transition-standard-time;
  width: $rmd-switch-track-width;

  &--disabled {
    @include rmd-form-theme-update-var(track-background-color, disabled-color);
  }
}

///
/// @access private
@mixin rmd-switch-input {
  @include rmd-form-input-hidden;

  &:disabled + .rmd-switch__ball {
    @include rmd-states-theme-update-var(hover-color, transparent);

    cursor: auto;

    &::after {
      @include rmd-form-theme(background-color, disabled-color);
    }
  }

  @include rmd-states-keyboard-only {
    &:focus + .rmd-switch__ball {
      @include rmd-states-theme-update-var(background-color, rmd-states-theme-var(focus-color));
    }

    &:focus:hover + .rmd-switch__ball {
      @include rmd-states-theme-update-var(background-color, rmd-states-theme-var(hover-color));
    }
  }

  @include rmd-states-touch-only {
    &:focus + .rmd-switch__ball,
    &:hover + .rmd-switch__ball {
      @include rmd-states-theme-update-var(background-color, transparent);
    }
  }

  &:checked + .rmd-switch__ball {
    $offset: $rmd-switch-ball-size + $rmd-switch-ball-offset;

    @include rmd-utils-rtl {
      transform: translateX(-$offset);
    }
    transform: translateX($offset);

    &::after {
      @include rmd-form-theme(background-color, active-color);
    }
  }

  &:checked:disabled + .rmd-switch__ball::after {
    background-color: $rmd-switch-ball-disabled-color;
  }
}

/// @access private
@mixin rmd-switch-ball {
  @include rmd-utils-hide-focus-outline;
  @include rmd-transition(standard);
  @include rmd-utils-rtl {
    left: auto;
    right: calc(-50% + #{$rmd-switch-ball-offset});
  }

  border-radius: $rmd-switch-ball-border-radius;
  height: $rmd-switch-ball-size * 2;
  left: calc(-50% + #{$rmd-switch-ball-offset});
  position: absolute;
  top: calc(-50% - #{$rmd-switch-ball-size - $rmd-switch-track-height});
  transition-duration: $rmd-transition-standard-time;
  transition-property: background-color, transform;
  width: $rmd-switch-ball-size * 2;
  z-index: 1;

  &::before {
    @include rmd-states-surface-base;
  }

  &:hover {
    @include rmd-states-theme-update-var(background-color, rmd-states-theme-var(hover-color));

    cursor: pointer;
  }

  &::after {
    @include rmd-elevation(1);

    background-color: darken($rmd-white-base, 5%);
    border-radius: inherit;
    content: '';
    height: $rmd-switch-ball-size;
    left: 25%;
    pointer-events: none;
    position: absolute;
    top: 25%;
    width: $rmd-switch-ball-size;
    z-index: 1;
  }
}

@mixin rmd-switch-container {
  padding: 0.5rem ($rmd-switch-ball-size / 2);
}
